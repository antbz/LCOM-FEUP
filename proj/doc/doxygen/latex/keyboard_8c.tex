\hypertarget{keyboard_8c}{}\section{/home/antonio/\+F\+E\+U\+P/2\+\_\+ano/1\+\_\+sem/\+L\+C\+O\+M/\+M\+I\+N\+I\+X-\/\+L\+C\+O\+M/shared/proj/src/src/keyboard.c File Reference}
\label{keyboard_8c}\index{/home/antonio/\+F\+E\+U\+P/2\+\_\+ano/1\+\_\+sem/\+L\+C\+O\+M/\+M\+I\+N\+I\+X-\/\+L\+C\+O\+M/shared/proj/src/src/keyboard.\+c@{/home/antonio/\+F\+E\+U\+P/2\+\_\+ano/1\+\_\+sem/\+L\+C\+O\+M/\+M\+I\+N\+I\+X-\/\+L\+C\+O\+M/shared/proj/src/src/keyboard.\+c}}
{\ttfamily \#include $<$lcom/lcf.\+h$>$}\newline
{\ttfamily \#include \char`\"{}../headers/keyboard.\+h\char`\"{}}\newline
Include dependency graph for keyboard.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{keyboard_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int() \hyperlink{keyboard_8c_a15cd0b00a8f834d25bbd39ea9c0519ea}{subscribe\+\_\+kbc} (uint8\+\_\+t $\ast$bit\+\_\+no)
\begin{DoxyCompactList}\small\item\em Subscribes keyboard\textquotesingle{}s interrupts. \end{DoxyCompactList}\item 
int() \hyperlink{keyboard_8c_a73757077133b7fe559d036ce133bcda5}{unsubscribe\+\_\+kbc} ()
\begin{DoxyCompactList}\small\item\em Unsubscribes keyboard\textquotesingle{}s interrupts. \end{DoxyCompactList}\item 
int \hyperlink{keyboard_8c_a9d17da4ed398d7cd4b3462ec31585cce}{kbd\+\_\+get\+\_\+status\+\_\+byte} (bool $\ast$preserve)
\begin{DoxyCompactList}\small\item\em Reads the K\+BC state. \end{DoxyCompactList}\item 
void() \hyperlink{keyboard_8c_a5761bd4aad91ac1d68916ad88f583d9f}{kbc\+\_\+ih} (void)
\item 
int \hyperlink{keyboard_8c_acf925ef53bcf49cda319a48d33b825e4}{kbc\+\_\+cmd\+\_\+read} (uint8\+\_\+t $\ast$out)
\begin{DoxyCompactList}\small\item\em Reads command byte. \end{DoxyCompactList}\item 
int \hyperlink{keyboard_8c_a9878df655d523f5c58423d305a912336}{kbc\+\_\+cmd\+\_\+write} (uint8\+\_\+t command)
\begin{DoxyCompactList}\small\item\em Writes command. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{keyboard_8c_a3f07434f2f0a6a358f8342924ceb3c74}{hookid} = 1
\item 
uint8\+\_\+t \hyperlink{keyboard_8c_a1cc545950661d96524585c500b3b68d1}{data} \mbox{[}2\mbox{]}
\item 
bool \hyperlink{keyboard_8c_aa02e483eb21e700531ca2ddf2508d189}{kbd\+\_\+valid}
\item 
bool \hyperlink{keyboard_8c_a78ab698245ea1f18f4b66d2cefbfa1f1}{two\+\_\+byte\+\_\+code}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{keyboard_8c_acf925ef53bcf49cda319a48d33b825e4}\label{keyboard_8c_acf925ef53bcf49cda319a48d33b825e4}} 
\index{keyboard.\+c@{keyboard.\+c}!kbc\+\_\+cmd\+\_\+read@{kbc\+\_\+cmd\+\_\+read}}
\index{kbc\+\_\+cmd\+\_\+read@{kbc\+\_\+cmd\+\_\+read}!keyboard.\+c@{keyboard.\+c}}
\subsubsection{\texorpdfstring{kbc\+\_\+cmd\+\_\+read()}{kbc\_cmd\_read()}}
{\footnotesize\ttfamily int kbc\+\_\+cmd\+\_\+read (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{out }\end{DoxyParamCaption})}



Reads command byte. 

Writes K\+BC command 0x20 to port 0x64, reading the byte in the output buffer to uint8\+\_\+t$\ast$ out.


\begin{DoxyParams}{Parameters}
{\em out} & pointer to where to store the command byte read. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=264pt]{keyboard_8c_acf925ef53bcf49cda319a48d33b825e4_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{keyboard_8c_a9878df655d523f5c58423d305a912336}\label{keyboard_8c_a9878df655d523f5c58423d305a912336}} 
\index{keyboard.\+c@{keyboard.\+c}!kbc\+\_\+cmd\+\_\+write@{kbc\+\_\+cmd\+\_\+write}}
\index{kbc\+\_\+cmd\+\_\+write@{kbc\+\_\+cmd\+\_\+write}!keyboard.\+c@{keyboard.\+c}}
\subsubsection{\texorpdfstring{kbc\+\_\+cmd\+\_\+write()}{kbc\_cmd\_write()}}
{\footnotesize\ttfamily int kbc\+\_\+cmd\+\_\+write (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{command }\end{DoxyParamCaption})}



Writes command. 

Writes K\+BC command 0x60 to port 0x64, and then writes the new value of the command byte to port 0x60.


\begin{DoxyParams}{Parameters}
{\em command} & command byte to be written. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}
\mbox{\Hypertarget{keyboard_8c_a5761bd4aad91ac1d68916ad88f583d9f}\label{keyboard_8c_a5761bd4aad91ac1d68916ad88f583d9f}} 
\index{keyboard.\+c@{keyboard.\+c}!kbc\+\_\+ih@{kbc\+\_\+ih}}
\index{kbc\+\_\+ih@{kbc\+\_\+ih}!keyboard.\+c@{keyboard.\+c}}
\subsubsection{\texorpdfstring{kbc\+\_\+ih()}{kbc\_ih()}}
{\footnotesize\ttfamily void() kbc\+\_\+ih (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{keyboard_8c_a5761bd4aad91ac1d68916ad88f583d9f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{keyboard_8c_a9d17da4ed398d7cd4b3462ec31585cce}\label{keyboard_8c_a9d17da4ed398d7cd4b3462ec31585cce}} 
\index{keyboard.\+c@{keyboard.\+c}!kbd\+\_\+get\+\_\+status\+\_\+byte@{kbd\+\_\+get\+\_\+status\+\_\+byte}}
\index{kbd\+\_\+get\+\_\+status\+\_\+byte@{kbd\+\_\+get\+\_\+status\+\_\+byte}!keyboard.\+c@{keyboard.\+c}}
\subsubsection{\texorpdfstring{kbd\+\_\+get\+\_\+status\+\_\+byte()}{kbd\_get\_status\_byte()}}
{\footnotesize\ttfamily int kbd\+\_\+get\+\_\+status\+\_\+byte (\begin{DoxyParamCaption}\item[{bool $\ast$}]{preserve }\end{DoxyParamCaption})}



Reads the K\+BC state. 

Reads the byte in the status register (port 0x64) and checks if it\textquotesingle{}s valid. Discards the value read if the parity, timeout or aux bits are set and checks the obf bit to see if there is data available for reading from the buffer.


\begin{DoxyParams}{Parameters}
{\em preserve} & bool that gets if what\textquotesingle{}s read is in a valid state or not \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if the operation was successful, 1 otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=291pt]{keyboard_8c_a9d17da4ed398d7cd4b3462ec31585cce_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{keyboard_8c_a15cd0b00a8f834d25bbd39ea9c0519ea}\label{keyboard_8c_a15cd0b00a8f834d25bbd39ea9c0519ea}} 
\index{keyboard.\+c@{keyboard.\+c}!subscribe\+\_\+kbc@{subscribe\+\_\+kbc}}
\index{subscribe\+\_\+kbc@{subscribe\+\_\+kbc}!keyboard.\+c@{keyboard.\+c}}
\subsubsection{\texorpdfstring{subscribe\+\_\+kbc()}{subscribe\_kbc()}}
{\footnotesize\ttfamily int() subscribe\+\_\+kbc (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{bit\+\_\+no }\end{DoxyParamCaption})}



Subscribes keyboard\textquotesingle{}s interrupts. 

Subscribes keyboard\textquotesingle{}s interrupt notifications using sys\+\_\+irqsetpolicy().


\begin{DoxyParams}{Parameters}
{\em bit\+\_\+no} & pointer to the hook\+\_\+id returned by the kernel in sys\+\_\+irqsetpolicy(). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if the operation was successful, 1 otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{keyboard_8c_a73757077133b7fe559d036ce133bcda5}\label{keyboard_8c_a73757077133b7fe559d036ce133bcda5}} 
\index{keyboard.\+c@{keyboard.\+c}!unsubscribe\+\_\+kbc@{unsubscribe\+\_\+kbc}}
\index{unsubscribe\+\_\+kbc@{unsubscribe\+\_\+kbc}!keyboard.\+c@{keyboard.\+c}}
\subsubsection{\texorpdfstring{unsubscribe\+\_\+kbc()}{unsubscribe\_kbc()}}
{\footnotesize\ttfamily int() unsubscribe\+\_\+kbc (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Unsubscribes keyboard\textquotesingle{}s interrupts. 

Unsubscribes keyboard\textquotesingle{}s interrupt notifications using sys\+\_\+irqrmpolicy().

\begin{DoxyReturn}{Returns}
0 if the operation was successful, 1 otherwise. 
\end{DoxyReturn}


\subsection{Variable Documentation}
\mbox{\Hypertarget{keyboard_8c_a1cc545950661d96524585c500b3b68d1}\label{keyboard_8c_a1cc545950661d96524585c500b3b68d1}} 
\index{keyboard.\+c@{keyboard.\+c}!data@{data}}
\index{data@{data}!keyboard.\+c@{keyboard.\+c}}
\subsubsection{\texorpdfstring{data}{data}}
{\footnotesize\ttfamily uint8\+\_\+t data\mbox{[}2\mbox{]}}

\mbox{\Hypertarget{keyboard_8c_a3f07434f2f0a6a358f8342924ceb3c74}\label{keyboard_8c_a3f07434f2f0a6a358f8342924ceb3c74}} 
\index{keyboard.\+c@{keyboard.\+c}!hookid@{hookid}}
\index{hookid@{hookid}!keyboard.\+c@{keyboard.\+c}}
\subsubsection{\texorpdfstring{hookid}{hookid}}
{\footnotesize\ttfamily int hookid = 1}

\mbox{\Hypertarget{keyboard_8c_aa02e483eb21e700531ca2ddf2508d189}\label{keyboard_8c_aa02e483eb21e700531ca2ddf2508d189}} 
\index{keyboard.\+c@{keyboard.\+c}!kbd\+\_\+valid@{kbd\+\_\+valid}}
\index{kbd\+\_\+valid@{kbd\+\_\+valid}!keyboard.\+c@{keyboard.\+c}}
\subsubsection{\texorpdfstring{kbd\+\_\+valid}{kbd\_valid}}
{\footnotesize\ttfamily bool kbd\+\_\+valid}

\mbox{\Hypertarget{keyboard_8c_a78ab698245ea1f18f4b66d2cefbfa1f1}\label{keyboard_8c_a78ab698245ea1f18f4b66d2cefbfa1f1}} 
\index{keyboard.\+c@{keyboard.\+c}!two\+\_\+byte\+\_\+code@{two\+\_\+byte\+\_\+code}}
\index{two\+\_\+byte\+\_\+code@{two\+\_\+byte\+\_\+code}!keyboard.\+c@{keyboard.\+c}}
\subsubsection{\texorpdfstring{two\+\_\+byte\+\_\+code}{two\_byte\_code}}
{\footnotesize\ttfamily bool two\+\_\+byte\+\_\+code}

