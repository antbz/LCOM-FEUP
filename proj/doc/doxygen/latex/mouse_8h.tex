\hypertarget{mouse_8h}{}\section{/home/antonio/\+F\+E\+U\+P/2\+\_\+ano/1\+\_\+sem/\+L\+C\+O\+M/\+M\+I\+N\+I\+X-\/\+L\+C\+O\+M/shared/proj/src/headers/mouse.h File Reference}
\label{mouse_8h}\index{/home/antonio/\+F\+E\+U\+P/2\+\_\+ano/1\+\_\+sem/\+L\+C\+O\+M/\+M\+I\+N\+I\+X-\/\+L\+C\+O\+M/shared/proj/src/headers/mouse.\+h@{/home/antonio/\+F\+E\+U\+P/2\+\_\+ano/1\+\_\+sem/\+L\+C\+O\+M/\+M\+I\+N\+I\+X-\/\+L\+C\+O\+M/shared/proj/src/headers/mouse.\+h}}


Functions to interface with the mouse.  


{\ttfamily \#include $<$lcom/lcf.\+h$>$}\newline
{\ttfamily \#include $<$lcom/utils.\+h$>$}\newline
{\ttfamily \#include $<$lcom/lab4.\+h$>$}\newline
{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include \char`\"{}keyboard.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}../headers/mouse\+\_\+defs.\+h\char`\"{}}\newline
Include dependency graph for mouse.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{mouse_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{mouse_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int() \hyperlink{mouse_8h_a757e4b5da5f470b256711c025c8f6c9e}{subscribe\+\_\+mouse} (uint8\+\_\+t $\ast$bit\+\_\+no)
\begin{DoxyCompactList}\small\item\em Subscribes mouse\textquotesingle{}s interrupts. \end{DoxyCompactList}\item 
int() \hyperlink{mouse_8h_aa228574f5c512312c12da4637d3abb45}{unsubscribe\+\_\+mouse} ()
\begin{DoxyCompactList}\small\item\em Unsubscribes mouse\textquotesingle{}s interrupts. \end{DoxyCompactList}\item 
int \hyperlink{mouse_8h_ad8f082d47fa7bde0306eb3b82b6127e9}{enable\+\_\+mouse} ()
\begin{DoxyCompactList}\small\item\em Enables mouse\textquotesingle{}s interrupts. \end{DoxyCompactList}\item 
int \hyperlink{mouse_8h_a22e7aa936a38417be07fc29cf34cfd05}{disable\+\_\+mouse} ()
\begin{DoxyCompactList}\small\item\em Disables mouse\textquotesingle{}s interrupts. \end{DoxyCompactList}\item 
int \hyperlink{mouse_8h_a82f07d6118c32948ba44ced307f66748}{mouse\+\_\+get\+\_\+status\+\_\+byte} (uint8\+\_\+t $\ast$status)
\begin{DoxyCompactList}\small\item\em Reads the mouse state. \end{DoxyCompactList}\item 
void() \hyperlink{mouse_8h_a210374b50462acdedab00df64d5cea3c}{mouse\+\_\+ih} ()
\begin{DoxyCompactList}\small\item\em Mouse interrupt handler. \end{DoxyCompactList}\item 
void \hyperlink{mouse_8h_a30e8c7c85734629add7c3fa01006a904}{assemble\+\_\+packet} (struct packet $\ast$\hyperlink{proj_8c_a26e83eca70c2b9169fbbb0eac7e32e32}{pp})
\begin{DoxyCompactList}\small\item\em Assembles the 3-\/byte data packet. \end{DoxyCompactList}\item 
int \hyperlink{mouse_8h_a2a3721c1f7166d799c22092fdb38ec00}{mouse\+\_\+cmd\+\_\+write} (uint8\+\_\+t command)
\begin{DoxyCompactList}\small\item\em Writes command. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Functions to interface with the mouse. 

File containing the functions to subscribe and handle the mouse\textquotesingle{}s interruptions. 

\subsection{Function Documentation}
\mbox{\Hypertarget{mouse_8h_a30e8c7c85734629add7c3fa01006a904}\label{mouse_8h_a30e8c7c85734629add7c3fa01006a904}} 
\index{mouse.\+h@{mouse.\+h}!assemble\+\_\+packet@{assemble\+\_\+packet}}
\index{assemble\+\_\+packet@{assemble\+\_\+packet}!mouse.\+h@{mouse.\+h}}
\subsubsection{\texorpdfstring{assemble\+\_\+packet()}{assemble\_packet()}}
{\footnotesize\ttfamily void assemble\+\_\+packet (\begin{DoxyParamCaption}\item[{struct packet $\ast$}]{pp }\end{DoxyParamCaption})}



Assembles the 3-\/byte data packet. 

Fills each field in the struct packet with the correct byte/bit from the bytes received


\begin{DoxyParams}{Parameters}
{\em pp} & pointer to the struct packet to store the received information \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mouse_8h_a22e7aa936a38417be07fc29cf34cfd05}\label{mouse_8h_a22e7aa936a38417be07fc29cf34cfd05}} 
\index{mouse.\+h@{mouse.\+h}!disable\+\_\+mouse@{disable\+\_\+mouse}}
\index{disable\+\_\+mouse@{disable\+\_\+mouse}!mouse.\+h@{mouse.\+h}}
\subsubsection{\texorpdfstring{disable\+\_\+mouse()}{disable\_mouse()}}
{\footnotesize\ttfamily int disable\+\_\+mouse (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Disables mouse\textquotesingle{}s interrupts. 

Disables interrupts on the mouse I\+RQ line (associated with the specified hook\+\_\+id) by calling function sys\+\_\+irqdisable().

\begin{DoxyReturn}{Returns}
value returned by sys\+\_\+irqdisable(). 
\end{DoxyReturn}
\mbox{\Hypertarget{mouse_8h_ad8f082d47fa7bde0306eb3b82b6127e9}\label{mouse_8h_ad8f082d47fa7bde0306eb3b82b6127e9}} 
\index{mouse.\+h@{mouse.\+h}!enable\+\_\+mouse@{enable\+\_\+mouse}}
\index{enable\+\_\+mouse@{enable\+\_\+mouse}!mouse.\+h@{mouse.\+h}}
\subsubsection{\texorpdfstring{enable\+\_\+mouse()}{enable\_mouse()}}
{\footnotesize\ttfamily int enable\+\_\+mouse (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Enables mouse\textquotesingle{}s interrupts. 

Enables interrupts on the mouse I\+RQ line (associated with the specified hook\+\_\+id) by calling function sys\+\_\+irqenable().

\begin{DoxyReturn}{Returns}
value returned by sys\+\_\+irqenable(). 
\end{DoxyReturn}
\mbox{\Hypertarget{mouse_8h_a2a3721c1f7166d799c22092fdb38ec00}\label{mouse_8h_a2a3721c1f7166d799c22092fdb38ec00}} 
\index{mouse.\+h@{mouse.\+h}!mouse\+\_\+cmd\+\_\+write@{mouse\+\_\+cmd\+\_\+write}}
\index{mouse\+\_\+cmd\+\_\+write@{mouse\+\_\+cmd\+\_\+write}!mouse.\+h@{mouse.\+h}}
\subsubsection{\texorpdfstring{mouse\+\_\+cmd\+\_\+write()}{mouse\_cmd\_write()}}
{\footnotesize\ttfamily int mouse\+\_\+cmd\+\_\+write (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{command }\end{DoxyParamCaption})}



Writes command. 

Reads the status byte to check if the input buffer is full, if not writes command 0x\+D4 to the kbc command register. Checks input buffer again and then writes the command byte to port 0x60. Re-\/sends command if failed in one byte, halts execution if there was an error in two consecutive bytes


\begin{DoxyParams}{Parameters}
{\em command} & command byte to be written. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if the operation was successful, 1 otherwise (-\/1 if there was an error) 
\end{DoxyReturn}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{mouse_8h_a2a3721c1f7166d799c22092fdb38ec00_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{mouse_8h_a82f07d6118c32948ba44ced307f66748}\label{mouse_8h_a82f07d6118c32948ba44ced307f66748}} 
\index{mouse.\+h@{mouse.\+h}!mouse\+\_\+get\+\_\+status\+\_\+byte@{mouse\+\_\+get\+\_\+status\+\_\+byte}}
\index{mouse\+\_\+get\+\_\+status\+\_\+byte@{mouse\+\_\+get\+\_\+status\+\_\+byte}!mouse.\+h@{mouse.\+h}}
\subsubsection{\texorpdfstring{mouse\+\_\+get\+\_\+status\+\_\+byte()}{mouse\_get\_status\_byte()}}
{\footnotesize\ttfamily int mouse\+\_\+get\+\_\+status\+\_\+byte (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{status }\end{DoxyParamCaption})}



Reads the mouse state. 

Reads the byte in the status register (port 0x64) and writes it to uint8\+\_\+t$\ast$ status


\begin{DoxyParams}{Parameters}
{\em status} & pointer to where to store the status byte read \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if the operation was successful, 1 otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{mouse_8h_a82f07d6118c32948ba44ced307f66748_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{mouse_8h_a210374b50462acdedab00df64d5cea3c}\label{mouse_8h_a210374b50462acdedab00df64d5cea3c}} 
\index{mouse.\+h@{mouse.\+h}!mouse\+\_\+ih@{mouse\+\_\+ih}}
\index{mouse\+\_\+ih@{mouse\+\_\+ih}!mouse.\+h@{mouse.\+h}}
\subsubsection{\texorpdfstring{mouse\+\_\+ih()}{mouse\_ih()}}
{\footnotesize\ttfamily void() mouse\+\_\+ih (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Mouse interrupt handler. 

Reads the mouse status byte and checks if there is data available for reading. If so, reads the byte in the output buffer and stores it in the correct byte of the 3-\/byte data packet Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{mouse_8h_a210374b50462acdedab00df64d5cea3c_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{mouse_8h_a757e4b5da5f470b256711c025c8f6c9e}\label{mouse_8h_a757e4b5da5f470b256711c025c8f6c9e}} 
\index{mouse.\+h@{mouse.\+h}!subscribe\+\_\+mouse@{subscribe\+\_\+mouse}}
\index{subscribe\+\_\+mouse@{subscribe\+\_\+mouse}!mouse.\+h@{mouse.\+h}}
\subsubsection{\texorpdfstring{subscribe\+\_\+mouse()}{subscribe\_mouse()}}
{\footnotesize\ttfamily int() subscribe\+\_\+mouse (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{bit\+\_\+no }\end{DoxyParamCaption})}



Subscribes mouse\textquotesingle{}s interrupts. 

Subscribes mouse\textquotesingle{}s interrupt notifications using sys\+\_\+irqsetpolicy().


\begin{DoxyParams}{Parameters}
{\em bit\+\_\+no} & pointer to the hook\+\_\+id returned by the kernel in sys\+\_\+irqsetpolicy(). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if the operation was successful, 1 otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{mouse_8h_aa228574f5c512312c12da4637d3abb45}\label{mouse_8h_aa228574f5c512312c12da4637d3abb45}} 
\index{mouse.\+h@{mouse.\+h}!unsubscribe\+\_\+mouse@{unsubscribe\+\_\+mouse}}
\index{unsubscribe\+\_\+mouse@{unsubscribe\+\_\+mouse}!mouse.\+h@{mouse.\+h}}
\subsubsection{\texorpdfstring{unsubscribe\+\_\+mouse()}{unsubscribe\_mouse()}}
{\footnotesize\ttfamily int() unsubscribe\+\_\+mouse (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Unsubscribes mouse\textquotesingle{}s interrupts. 

Unsubscribes mouse\textquotesingle{}s interrupt notifications using sys\+\_\+irqrmpolicy().

\begin{DoxyReturn}{Returns}
0 if the operation was successful, 1 otherwise. 
\end{DoxyReturn}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{mouse_8h_aa228574f5c512312c12da4637d3abb45_cgraph}
\end{center}
\end{figure}
